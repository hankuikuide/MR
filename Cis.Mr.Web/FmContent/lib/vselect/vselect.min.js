!function(e,t,i){function l(e){return"undefined"==typeof e}function a(e){return"function"==typeof e}function s(){var e={left:0,top:0,width:0,height:0};return self.innerHeight?(e.height=self.innerHeight,e.width=self.innerWidth,e.left=self.pageXOffset,e.top=self.pageYOffset):r?(e.height=t.documentElement.clientHeight,e.width=t.documentElement.clientWidth,e.top=t.documentElement.scrollTop,e.left=t.documentElement.scrollLeft):t.body&&(e.height=t.body.clientHeight,e.width=t.body.clientWidth,e.left=t.body.scrollLeft,e.top=t.body.scrollTop),e}function h(){_=!0,e(i).resize(function(){if(!(g.length<1)){var e,t,i,n;for(e=0;e<g.length;e++)t=g[e],i=t._panel,n=m.panelPosition(t,i,m.options(t)),i.css({left:n.x,top:n.y})}}),e(t).click(function(i){var n,l,a=e(i.srcElement?i.srcElement:i.target);a.hasClass(d.panel)||a.hasClass(d.select)||a.hasClass(d.tab)||(n=a.parent(),n.hasClass(d.select)||n.hasClass(d.tab)||(n=n.parent().parent(),n.hasClass(d.panel)&&(l=t.getElementById(n.attr("id").slice(0,-5)))&&l&&"undefined"!=typeof l._multiple&&l._multiple||m.hideAll()))}).keyup(function(e){e||(e=i.event);var t=e.keyCode?e.keyCode:e.which;27==t&&m.hideAll()}),e("body:first").append('<div class="'+d.shadow+'" id="__'+d.select+'_shadow" style="display:none">&nbsp;</div>'),f=e("#__"+d.select+"_shadow")}var o=!!i.ActiveXObject,r=o&&!i.XMLHttpRequest,c={multipleJointer:"|^|",speed:"fast",shadow:!1},d={select:"vselect",linkOn:"vselect-link-on",panel:"vselect-panel",shadow:"vselect-shadow",tab:"vselect-panel-tab",tabOn:"vselect-panel-tab-on",tabHover:"vselect-panel-tab-hover",disabled:"vselect-disabled"},u={selectedValue:null,grouplessLabel:"其他",direction:"bottom",styleString:null,width:null,maxHeight:400,maxColumn:1,maxTop:0},p=1,f=null,g=[],v={},_=!1,m={init:function(e){_||h(),e=e||{};for(var t in u)"undefined"==typeof e[t]&&(e[t]=u[t]);return this.each(function(){m.selectInit.call(this,e)})},selectInit:function(t){var i,n,l,a;if(this.name||this.id){a=e(this).val(),l=e(this).find("optgroup").length>0,n=m._createDom(this,t,l),i=n[0],i._options=t,i._panel=e("#__"+d.select+(p-1)+"panel"),i._value=n.find("input:first"),i._caption=n.find("em:first"),t.width>0&&n.css("width",t.width),i._selectWidth=n.width(),i._group=l,i._multiple=this.multiple,i._initSelectedIndex=this.options.selectedIndex,i._origMaxHeight=t.maxHeight,i._column=1,l?(i._tab=i._panel.find("div."+d.tab+":first"),m.panelInitWithOptgroup(i,i._panel,t),m.panelArrangeWithOptgroup(i,i._panel,t)):(m.panelInit(i,i._panel,t),m.panelArrange(i,i._panel,t)),n.click(m.selectClick);var s=e(this).attr("disabled");e(this).remove(),m.setValue.call(i,null===t.selectedValue?a:t.selectedValue),m.vselectSetDisabled.call(i,"disabled"===s)}},panelInit:function(t,i,n){var a,s=e(i).find("a");for(a=0;a<s.length;a++)l(s[a].getAttribute("rel"))||(s[a].onclick=function(e){m.itemClick.call(t,e,this.getAttribute("rel"))})},panelArrange:function(t,i,l){var a=m.borderSize(i),s=e(t).outerWidth()-a.width;n=1;var h=i.find("li");tmp=[];for(var o=0;o<h.length;o++)liTextLength=h[o].innerText,tmp.push(liTextLength);var r=0;if(tmp.length>0){r=tmp[0].length;for(var o=1;o<tmp.length;o++)r<tmp[o].length&&(r=tmp[o].length)}for(s=r>7?e(t).outerWidth()-a.width>400?r>25?14*r:e(t).outerWidth()-a.width:14*r:e(t).outerWidth()-a.width,200>s&&(s=l.dropWidth||200),i.find("ul").hide().eq(0).css("display","block"),i.css({width:s,height:"auto"}).find("li").css("width",s);(t._panelHeight=i.height())>l.maxHeight;){if(!(++n<=l.maxColumn)){l.maxHeight=i.height();break}i.css("width",s*n)}"__vselect14"==e(t).attr("id")&&h.length>7&&i.css({width:s+20}),t._column=n,t._showWidth=i.css("width")},panelInitWithOptgroup:function(t,i,n){i.find("div."+d.tab+" em").hover(function(){e(this).addClass(d.tabHover)},function(){e(this).removeClass(d.tabHover)}).each(function(e){this.onclick=function(){m.panelTabClick(t,e)}}),i.find("> ul").each(function(){m.panelInit(t,this,n)})},panelArrangeWithOptgroup:function(t,i,n){var l=m.borderSize(i),a=e(t).outerWidth()-l.width,s=i.find("> ul");s.length<1||(t._panelWidth=0,t._panelHeight=0,t._panelTabWidth=0,t._panelTabHeight=0,gridHeight=i.find("li:first").height(),s.each(function(){var l,h=e(this),o=1;for(s.hide(),h.css("display","block"),i.css({width:a,height:"auto"}),h.find("li").css("width",a);(l=i.height())>n.maxHeight&&++o<=n.maxColumn;)i.css("width",a*o);t._panelWidth=Math.max(i.width(),t._panelWidth),t._column=Math.max(o,t._column)}),s.each(function(){var l,h=e(this),o=1;for(s.hide(),h.css("display","block"),i.css({width:t._panelWidth,height:"auto"}),h.find("li").css("width",a);(l=i.height())>n.maxHeight;){if(!(++o<=n.maxColumn)){n.maxHeight=i.height();break}i.css("width",a*o)}t._panelHeight=Math.max(i.height(),t._panelHeight)}),t._showWidth=i.css("width"),m.panelActiveSelectedTab(t))},_createDom:function(i,n,l){var a,s,h,o,r,c,u="",f="";if(i._width=n.width,l){for(o=e(i).find("optgroup"),a=0;a<o.size();a++)f+="<em>"+(o[a].label||index)+"</em>",u+=m._createBlock(o[a]);e(i).find("> option").size()>0&&(f+="<em>"+n.grouplessLabel+"</em>",u+=m._createBlock(i)),f='<div class="'+d.tab+'">'+f+"</div>"}else u=m._createBlock(i,!0);return s=i.id?' id="'+i.id+'" ':"",h=i.name?' name="'+i.name+'" ':"",r=i.getAttribute("title")?' title="'+i.getAttribute("title")+'" ':"",c=n.styleString?' style="'+n.styleString+'" ':"",e(i).after('<a href="javascript:;" class="'+d.select+'" id="__'+d.select+p+'"'+r+c+'><input type="hidden" '+s+h+' value="" /><em></em><i>&#9660;</i></a>'),e("body:first").append('<div class="'+d.panel+'" id="__'+d.select+p+'panel" style="display:none">'+f+u+"</div>"),e(t.getElementById("__"+d.select+p++))},_createBlock:function(t,i){var n,a="",s=e(t).find("> option");for(n=0;n<s.length;n++)l(s[n].text)&&(s[n].text=s[n].value),a+='<li><a href="javascript:;" rel="'+s[n].value+'">'+s[n].text+"</a></li>";return"undefined"!=typeof i&&i&&1==s.length&&(a+="<li>&nbsp;</li>"),s.length>7?'<ul  style="overflow: auto;" >'+a+"</ul>":"<ul>"+a+"</ul>"},setValue:function(t){var i,n,a=null,s=this,h=e(s),o=(m.options(s),s._panel.find("a"));if(s._multiple){var r=[],u=[];for(i=0;i<o.length;i++)n=o[i],l(n.rel)||n.rel!=t||(n.className=n.className==d.linkOn?"":d.linkOn),n.className==d.linkOn&&(r.push(n.innerHTML),u.push(n.rel));t=a="",u.length>0&&(a=r.join(","),t=u.join(c.multipleJointer))}else{for(o.removeClass(d.linkOn),i=0;i<o.length;i++)n=o[i],l(n.rel)||n.rel!=t||(n.className=d.linkOn,a=n.innerHTML);null===a&&o.length>0&&(t=o[0].rel,a=o[0].innerHTML)}var p="";if(s._selectWidth>300?null!==a&&(p=a.length>34?a.substr(0,34):a):null!==a&&(p=a.length>13?a.substr(0,13):a),s._caption.html(p),s._value.val(t).attr("rel",a),s._caption.width()+26>s._selectWidth&&h.width(s._selectWidth),s._caption.width()+26<s._selectWidth&&h.width(s._selectWidth),s._group){var i,f={};s._tab.find("em").css("text-decoration","none"),s._panel.find("a."+d.linkOn).each(function(){f[e(this).parent().parent().index()-1]=1});for(i in f)s._tab.find("em:eq("+i+")").css("text-decoration","underline")}},selectClick:function(e){m.haltEvent(e),m.hideAll(),m.show.call(this)},itemClick:function(e,t,i){var n=this,l=m.options(n),s=t!=n._value.val();n._multiple||m.hideAll(),m.setValue.call(n,t),(a(l.click)||s&&a(l.change))&&(i||m.haltEvent(e),a(l.click)&&l.click.call(n._value,e,t),s&&a(l.change)&&l.change.call(n._value,e,t))},clickValue:function(e){var t=this._panel.find("a[rel='"+e+"']");t.length>0&&(m.itemClick.call(this,i.event,e,!0),this._tab&&m.panelActiveSelectedTab(this))},panelTabClick:function(e,t){var i=e._panel.find("div."+d.tab);i.find("em").removeClass(d.tabOn).eq(t).addClass(d.tabOn),e._panel.find("> ul").hide().eq(t).show(),e._panel.css({width:e._panelWidth,height:e._panelHeight})},panelActiveSelectedTab:function(e){var t,i=e._panel.find("> ul");for(t=0;t<i.length&&!(i.eq(t).find("a."+d.linkOn).length>0);t++);t>=i.length&&(t=0),i.hide().eq(t).show(),e._tab.find("em").removeClass(d.tabOn).eq(t).addClass(d.tabOn)},panelPosition:function(t,i,n,l){var a,h,o,r,c=s(),d=e(t),n=m.options(t),u=0;if(a=m.borderSize(i),r=parseInt(t._showWidth),e(i.find("li")).length<6)for(var p=0;p<e(i.find("li")).length;p++)u+=28;else u=Math.min(t._panelHeight,n.maxHeight);switch(h=l?i.offset().left:d.offset().left,n.direction){case"top":o=d.offset().top+d.outerHeight()-u-a.height;break;case"bottom":o=d.offset().top;break;default:o=d.offset().top+(d.outerHeight()>>1)-(u>>1)-(a.height>>1)}return o<c.top+n.maxTop&&(o=d.offset().top),o+u>c.top+c.height&&(o=d.offset().top+d.outerHeight()-u-a.height),o+u>c.top+c.height&&(o=c.top+c.height-u-a.height),h+r>c.left+c.width&&(h=c.left+c.width-r-a.width),0>h&&(h=0),0>o&&(o=n.maxTop),{x:h,y:o,w:r,h:u}},show:function(){if(!this._isDisabled){var t,i,n,l=this,s=e(l),h=m.options(l),o=l._panel;s.blur(),o.is(":visible")||(v[l.id]=!0,t=m.borderSize(o),o.show().css({height:s.outerHeight()-t.height,left:s.offset().left,top:s.offset().top}),l._group&&o.css("width",l._panelWidth),i=m.panelPosition(l,o,h,!0),n={height:i.h,left:i.x,top:i.y},l._column>1&&(n.width=l._showWidth,o.css("width",s.outerWidth())),"top"==h.direction&&o.css("top",s.offset().top+1),l._panel.animate(n,c.speed,function(){v[l.id]=!1,a(h.show)&&h.show.call(l)}),c.shadow&&f.show().css({width:o.width(),height:s.outerHeight()-t.height,left:s.offset().left,top:s.offset().top}).animate({height:i.h,left:i.x+6,top:i.y+6},c.speed),g.push(l))}},hide:function(){var t,i,n=this,l=m.options(n),s=e(this),h=this._panel,o=m.borderSize(h);t=h.css("z-index"),h.css("z-index",t-1),"top"==l.direction&&h.css("top",parseInt(h.css("top"))+1),i={height:s.outerHeight()-o.height,left:s.offset().left,top:s.offset().top},n._column>1&&(i.width=s.outerWidth()),h.animate(i,c.speed,function(){h.hide(),h.css("z-index",t),a(l.hide)&&l.hide.call(n)}),c.shadow&&f.hide()},hideAll:function(){for(var e;e=g.pop();)m.hide.call(e)},reset:function(t,i){var n,a=this,s=a._panel,h=m.options(a),o="",r=0;a._initSelectedIndex=-1,h.maxHeight=a._origMaxHeight,l(i)||(h.selectedValue=i);for(var c=0;c<t.length;c++)n=t[c],o+=(typeof n).toString()===(typeof{}).toString()?'<li><a href="javascript:;" title="'+n.text+'" rel="'+n.value+'">'+n.text+"</a></li>":'<li><a href="javascript:;" title="'+t[n]+'" rel="'+t[n]+'">'+t[n]+"</a></li>",r++;1==r&&(o+="<li>&nbsp;</li>"),s.empty().html(t.length>7?"__vselect14"==e(a).attr("id")?'<ul style="height: 196px;overflow: auto;">'+o+"</ul>":'<ul style="overflow: auto;">'+o+"</ul>":"<ul>"+o+"</ul>"),m.panelInit(a,s,h),m.panelArrange(a,s,h),m.setValue.call(a,h.selectedValue)},haltEvent:function(e){return e=e||i.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1},borderSize:function(t){var i=e(t);return{width:parseInt(i.css("border-left-width"))+parseInt(i.css("border-right-width")),height:parseInt(i.css("border-top-width"))+parseInt(i.css("border-bottom-width"))}},options:function(e){return e._options?e._options:{}},value:function(){return this._value?this._value.val():this.value},caption:function(){return this._value?this._value[0].getAttribute("rel"):this.getAttribute("rel")},vselectSetDisabled:function(t){var i=this,n=e(i);i._isDisabled=t,n.hasClass(d.select)&&(t?n.addClass(d.disabled):n.removeClass(d.disabled))}};e.vselect={config:function(e){return"undefined"==typeof c[e]?void 0:c[e]},setConfig:function(e,t){switch(typeof e){case"object":for(var i in e)c[i]=e[i];return;case"array":for(var i=0;i<e.length;i++)c[i]=e[i];return}c[e]=t},style:function(e){return"undefined"==typeof d[e]?void 0:d[e]},setStyle:function(e,t){switch(typeof e){case"object":for(var i in e)d[i]=e[i];return;case"array":for(var i=0;i<e.length;i++)d[i]=e[i];return}d[e]=t},hide:m.hideAll},e.fn.extend({vselect:function(){return m.init.apply(this,arguments)},vselectShow:function(){var t=arguments;return this.each(function(){m.show.apply(this._panel?this:e(this).parent()[0],t)})},vselectHide:function(){var t=arguments;return this.each(function(){m.hide.apply(this._panel?this:e(this).parent()[0],t)})},vselectValue:function(){return this.size()<1?null:m.value.apply(this[0])},vselectSetValue:function(e){return this.size()<1?null:m.setValue.call(this.parent()[0],e)},vselectClickValue:function(e){return this.size()<1?null:m.clickValue.call(this.parent()[0],e)},vselectCaption:function(){return this.size()<1?null:m.caption.call(this[0])},vselectReset:function(){var t=arguments;return this.each(function(){m.reset.apply(this._panel?this:e(this).parent()[0],t)})},vselectSetDisabled:function(e){return this.size()<1?null:m.vselectSetDisabled.call(this.parent()[0],e)}})}(jQuery,document,window);